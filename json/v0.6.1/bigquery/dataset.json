{"id":"dataset","metadata":{"name":"Dataset","description":"<h1 id=\"dataset\">Dataset</h1>\n\n<p>Represents a Dataset. A dataset is a grouping mechanism that holds zero or\nmore tables. Datasets are the lowest level unit of access control; you\ncannot control access at the table level. A dataset is contained within a\nspecific project.</p>","source":"lib/gcloud/bigquery/dataset.rb#L43","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\n\ndataset = bigquery.create_dataset \"my_dataset\",\n                                  name: \"My Dataset\",\n                                  description: \"This is my Dataset\""}]},"methods":[{"metadata":{"name":"dataset_id","description":"<p>A unique ID for this dataset, without the project name.\nThe ID must contain only letters (a-z, A-Z), numbers (0-9),\nor underscores (_). The maximum length is 1,024 characters.</p>","source":"lib/gcloud/bigquery/dataset.rb#L66","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"project_id","description":"<p>The ID of the project containing this dataset.</p>","source":"lib/gcloud/bigquery/dataset.rb#L75","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"name","description":"<p>A descriptive name for the dataset.</p>","source":"lib/gcloud/bigquery/dataset.rb#L94","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"name=","description":"<p>Updates the descriptive name for the dataset.</p>","source":"lib/gcloud/bigquery/dataset.rb#L103","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"etag","description":"<p>A string hash of the dataset.</p>","source":"lib/gcloud/bigquery/dataset.rb#L112","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"api_url","description":"<p>A URL that can be used to access the dataset using the REST API.</p>","source":"lib/gcloud/bigquery/dataset.rb#L122","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"description","description":"<p>A user-friendly description of the dataset.</p>","source":"lib/gcloud/bigquery/dataset.rb#L132","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"description=","description":"<p>Updates the user-friendly description of the dataset.</p>","source":"lib/gcloud/bigquery/dataset.rb#L142","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"default_expiration","description":"<p>The default lifetime of all tables in the dataset, in milliseconds.</p>","source":"lib/gcloud/bigquery/dataset.rb#L151","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"default_expiration=","description":"<p>Updates the default lifetime of all tables in the dataset, in\nmilliseconds.</p>","source":"lib/gcloud/bigquery/dataset.rb#L162","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"created_at","description":"<p>The time when this dataset was created.</p>","source":"lib/gcloud/bigquery/dataset.rb#L171","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"modified_at","description":"<p>The date when this dataset or any of its tables was last modified.</p>","source":"lib/gcloud/bigquery/dataset.rb#L181","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"location","description":"<p>The geographic location where the dataset should reside. Possible\nvalues include EU and US. The default value is US.</p>","source":"lib/gcloud/bigquery/dataset.rb#L192","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"access","description":"<p>Retrieves the access rules for a Dataset using the Google Cloud\nDatastore API data structure of an array of hashes. The rules can be\nupdated when passing a block, see <a data-custom-type=\"bigquery/dataset/access\">Dataset::Access</a> for all the methods\navailable.</p>","source":"lib/gcloud/bigquery/dataset.rb#L240","resources":[{"title":"BigQuery Access\nControl","link":"https://cloud.google.com/bigquery/access-control"}],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\n\ndataset.access #=> [{\"role\"=>\"OWNER\",\n               #     \"specialGroup\"=>\"projectOwners\"},\n               #    {\"role\"=>\"WRITER\",\n               #     \"specialGroup\"=>\"projectWriters\"},\n               #    {\"role\"=>\"READER\",\n               #     \"specialGroup\"=>\"projectReaders\"},\n               #    {\"role\"=>\"OWNER\",\n               #     \"userByEmail\"=>\"123456789-...com\"}]"},{"caption":"Manage the access rules by passing a block:","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\n\ndataset.access do |access|\n  access.add_owner_group \"owners@example.com\"\n  access.add_writer_user \"writer@example.com\"\n  access.remove_writer_user \"readers@example.com\"\n  access.add_reader_special :all\n  access.add_reader_view other_dataset_view_object\nend"}]},"params":[{"name":"yield","types":["block"],"description":"a block for setting rules","optional":true,"nullable":false},{"name":"yield.access","types":["Dataset::Access"],"description":"the object accepting rules","optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"metadata":{"name":"access=","description":"<p>Sets the access rules for a Dataset using the Google Cloud Datastore API\ndata structure of an array of hashes. See <a href=\"https://cloud.google.com/bigquery/access-control\">BigQuery Access\nControl</a> for more\ninformation.</p>\n\n<p>This method is provided for advanced usage of managing the access rules.\nCalling <a data-custom-type=\"#access\">#access</a> with a block is the preferred way to manage access\nrules.</p>","source":"lib/gcloud/bigquery/dataset.rb#L277","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\n\ndataset.access = [{\"role\"=>\"OWNER\",\n                   \"specialGroup\"=>\"projectOwners\"},\n                  {\"role\"=>\"WRITER\",\n                   \"specialGroup\"=>\"projectWriters\"},\n                  {\"role\"=>\"READER\",\n                   \"specialGroup\"=>\"projectReaders\"},\n                  {\"role\"=>\"OWNER\",\n                   \"userByEmail\"=>\"123456789-...com\"}]"}]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"delete","description":"<p>Permanently deletes the dataset. The dataset must be empty before it can\nbe deleted unless the <code class=\"highlighter-rouge\">force</code> option is set to <code class=\"highlighter-rouge\">true</code>.</p>","source":"lib/gcloud/bigquery/dataset.rb#L302","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\n\ndataset = bigquery.dataset \"my_dataset\"\ndataset.delete"}]},"params":[{"name":"force","types":["Boolean"],"description":"If <code class=\"highlighter-rouge\">true</code>, delete all the tables in the dataset.\nIf <code class=\"highlighter-rouge\">false</code> and the dataset contains tables, the request will fail.\nDefault is <code class=\"highlighter-rouge\">false</code>.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Boolean"],"description":"Returns <code class=\"highlighter-rouge\">true</code> if the dataset was deleted."}]},{"metadata":{"name":"create_table","description":"<p>Creates a new table. If you are adapting existing code that was written\nfor the <a href=\"https://cloud.google.com/bigquery/docs/reference/v2/tables#resource\">Rest API\n</a>,\nyou can pass the table’s schema as a hash (see example.)</p>","source":"lib/gcloud/bigquery/dataset.rb#L402","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\ntable = dataset.create_table \"my_table\""},{"caption":"You can also pass name and description options.","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\ntable = dataset.create_table \"my_table\"\n                             name: \"My Table\",\n                             description: \"A description of my table.\""},{"caption":"You can define the table’s schema using a block.","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\ntable = dataset.create_table \"my_table\" do |schema|\n  schema.string \"first_name\", mode: :required\n  schema.record \"cities_lived\", mode: :repeated do |nested_schema|\n    nested_schema.string \"place\", mode: :required\n    nested_schema.integer \"number_of_years\", mode: :required\n  end\nend"},{"caption":"You can pass the table’s schema as a hash.","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\n\nschema = {\n  \"fields\" => [\n    {\n      \"name\" => \"first_name\",\n      \"type\" => \"STRING\",\n      \"mode\" => \"REQUIRED\"\n    },\n    {\n      \"name\" => \"cities_lived\",\n      \"type\" => \"RECORD\",\n      \"mode\" => \"REPEATED\",\n      \"fields\" => [\n        {\n          \"name\" => \"place\",\n          \"type\" => \"STRING\",\n          \"mode\" => \"REQUIRED\"\n        },\n        {\n          \"name\" => \"number_of_years\",\n          \"type\" => \"INTEGER\",\n          \"mode\" => \"REQUIRED\"\n        }\n      ]\n    }\n  ]\n}\ntable = dataset.create_table \"my_table\", schema: schema"}]},"params":[{"name":"table_id","types":["String"],"description":"The ID of the table. The ID must contain only\nletters (a-z, A-Z), numbers (0-9), or underscores (_). The maximum\nlength is 1,024 characters.","optional":false,"nullable":false},{"name":"name","types":["String"],"description":"A descriptive name for the table.","optional":true,"default":"nil","nullable":true},{"name":"description","types":["String"],"description":"A user-friendly description of the table.","optional":true,"default":"nil","nullable":true},{"name":"schema","types":["Hash"],"description":"A hash specifying fields and data types for the\ntable. A block may be passed instead (see examples.) For the format of\nthis hash, see the <a href=\"https://cloud.google.com/bigquery/docs/reference/v2/tables#resource\">Tables resource\n</a>\n.","optional":true,"default":"nil","nullable":true},{"name":"yield","types":["block"],"description":"a block for setting the schema","optional":true,"nullable":false},{"name":"yield.schema","types":["Table::Schema"],"description":"the object accepting the schema","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Gcloud::Bigquery::Table"],"description":null}]},{"metadata":{"name":"create_view","description":"<p>Creates a new view table from the given query.</p>","source":"lib/gcloud/bigquery/dataset.rb#L450","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\nview = dataset.create_view \"my_view\",\n          \"SELECT name, age FROM [proj:dataset.users]\""},{"caption":"A name and description can be provided:","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\nview = dataset.create_view \"my_view\",\n          \"SELECT name, age FROM [proj:dataset.users]\",\n          name: \"My View\", description: \"This is my view\""}]},"params":[{"name":"table_id","types":["String"],"description":"The ID of the view table. The ID must contain\nonly letters (a-z, A-Z), numbers (0-9), or underscores (_). The\nmaximum length is 1,024 characters.","optional":false,"nullable":false},{"name":"query","types":["String"],"description":"The query that BigQuery executes when the view is\nreferenced.","optional":false,"nullable":false},{"name":"name","types":["String"],"description":"A descriptive name for the table.","optional":true,"default":"nil","nullable":true},{"name":"description","types":["String"],"description":"A user-friendly description of the table.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Gcloud::Bigquery::View"],"description":null}]},{"metadata":{"name":"table","description":"<p>Retrieves an existing table by ID.</p>","source":"lib/gcloud/bigquery/dataset.rb#L474","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\ntable = dataset.table \"my_table\"\nputs table.name"}]},"params":[{"name":"table_id","types":["String"],"description":"The ID of a table.","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Gcloud::Bigquery::Table","Gcloud::Bigquery::View","nil"],"description":"Returns\n<code class=\"highlighter-rouge\">nil</code> if the table does not exist"}]},{"metadata":{"name":"tables","description":"<p>Retrieves the list of tables belonging to the dataset.</p>","source":"lib/gcloud/bigquery/dataset.rb#L526","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\ntables = dataset.tables\ntables.each do |table|\n  puts table.name\nend"},{"caption":"With pagination: (See <a data-custom-type=\"bigquery/dataset/list#token\">Dataset::List#token</a>)","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\ndataset = bigquery.dataset \"my_dataset\"\n\nall_tables = []\ntmp_tables = dataset.tables\nwhile tmp_tables.any? do\n  tmp_tables.each do |table|\n    all_tables << table\n  end\n  # break loop if no more tables available\n  break if tmp_tables.token.nil?\n  # get the next group of tables\n  tmp_tables = dataset.tables token: tmp_tables.token\nend"}]},"params":[{"name":"token","types":["String"],"description":"A previously-returned page token representing part\nof the larger set of results to view.","optional":true,"default":"nil","nullable":true},{"name":"max","types":["Integer"],"description":"Maximum number of tables to return.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Array<Gcloud::Bigquery::Table>","Array<Gcloud::Bigquery::View>"],"description":"(See <a data-custom-type=\"bigquery/table/list\">Gcloud::Bigquery::Table::List</a>)"}]},{"metadata":{"name":"query_job","description":"<p>Queries data using the <a href=\"https://cloud.google.com/bigquery/querying-data\">asynchronous\nmethod</a>.</p>\n\n<p>Sets the current dataset as the default dataset in the query. Useful for\nusing unqualified table names.</p>","source":"lib/gcloud/bigquery/dataset.rb#L600","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\n\njob = bigquery.query_job \"SELECT name FROM my_table\"\n\njob.wait_until_done!\nif !job.failed?\n  job.query_results.each do |row|\n    puts row[\"name\"]\n  end\nend"}]},"params":[{"name":"query","types":["String"],"description":"A query string, following the BigQuery <a href=\"https://cloud.google.com/bigquery/query-reference\">query\nsyntax</a>, of the\nquery to execute. Example: “SELECT count(f1) FROM\n[myProjectId:myDatasetId.myTableId]”.","optional":false,"nullable":false},{"name":"priority","types":["String"],"description":"Specifies a priority for the query. Possible\nvalues include <code class=\"highlighter-rouge\">INTERACTIVE</code> and <code class=\"highlighter-rouge\">BATCH</code>. The default value is\n<code class=\"highlighter-rouge\">INTERACTIVE</code>.","optional":true,"default":"\"INTERACTIVE\"","nullable":false},{"name":"cache","types":["Boolean"],"description":"Whether to look for the result in the query\ncache. The query cache is a best-effort cache that will be flushed\nwhenever tables in the query are modified. The default value is true.\nFor more information, see <a href=\"https://developers.google.com/bigquery/querying-data\">query\ncaching</a>.","optional":true,"default":"true","nullable":false},{"name":"table","types":["Table"],"description":"The destination table where the query results\nshould be stored. If not present, a new table will be created to store\nthe results.","optional":true,"default":"nil","nullable":true},{"name":"create","types":["String"],"description":"Specifies whether the job is allowed to create\nnew tables.</p>\n\n<p>The following values are supported:\n* <code class=\"highlighter-rouge\">needed</code> - Create the table if it does not exist.\n* <code class=\"highlighter-rouge\">never</code> - The table must already exist. A ‘notFound’ error is\n  raised if the table does not exist.","optional":true,"default":"nil","nullable":true},{"name":"write","types":["String"],"description":"Specifies the action that occurs if the\ndestination table already exists.</p>\n\n<p>The following values are supported:\n* <code class=\"highlighter-rouge\">truncate</code> - BigQuery overwrites the table data.\n* <code class=\"highlighter-rouge\">append</code> - BigQuery appends the data to the table.\n* <code class=\"highlighter-rouge\">empty</code> - A ‘duplicate’ error is returned in the job result if the\n  table exists and contains data.","optional":true,"default":"nil","nullable":true},{"name":"large_results","types":["Boolean"],"description":"If <code class=\"highlighter-rouge\">true</code>, allows the query to produce\narbitrarily large result tables at a slight cost in performance.\nRequires <code class=\"highlighter-rouge\">table</code> parameter to be set.","optional":true,"default":"nil","nullable":true},{"name":"flatten","types":["Boolean"],"description":"Flattens all nested and repeated fields in the\nquery results. The default value is <code class=\"highlighter-rouge\">true</code>. <code class=\"highlighter-rouge\">large_results</code> parameter\nmust be <code class=\"highlighter-rouge\">true</code> if this is set to <code class=\"highlighter-rouge\">false</code>.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Gcloud::Bigquery::QueryJob"],"description":null}]},{"metadata":{"name":"query","description":"<p>Queries data using the <a href=\"https://cloud.google.com/bigquery/querying-data\">synchronous\nmethod</a>.</p>\n\n<p>Sets the current dataset as the default dataset in the query. Useful for\nusing unqualified table names.</p>","source":"lib/gcloud/bigquery/dataset.rb#L663","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nbigquery = gcloud.bigquery\n\ndata = bigquery.query \"SELECT name FROM my_table\"\ndata.each do |row|\n  puts row[\"name\"]\nend"}]},"params":[{"name":"query","types":["String"],"description":"A query string, following the BigQuery <a href=\"https://cloud.google.com/bigquery/query-reference\">query\nsyntax</a>, of the\nquery to execute. Example: “SELECT count(f1) FROM\n[myProjectId:myDatasetId.myTableId]”.","optional":false,"nullable":false},{"name":"max","types":["Integer"],"description":"The maximum number of rows of data to return per\npage of results. Setting this flag to a small value such as 1000 and\nthen paging through results might improve reliability when the query\nresult set is large. In addition to this limit, responses are also\nlimited to 10 MB. By default, there is no maximum row count, and only\nthe byte limit applies.","optional":true,"default":"nil","nullable":true},{"name":"timeout","types":["Integer"],"description":"How long to wait for the query to complete, in\nmilliseconds, before the request times out and returns. Note that this\nis only a timeout for the request, not the query. If the query takes\nlonger to run than the timeout value, the call returns without any\nresults and with QueryData#complete? set to false. The default value\nis 10000 milliseconds (10 seconds).","optional":true,"default":"10000","nullable":false},{"name":"dryrun","types":["Boolean"],"description":"If set to <code class=\"highlighter-rouge\">true</code>, BigQuery doesn’t run the job.\nInstead, if the query is valid, BigQuery returns statistics about the\njob such as how many bytes would be processed. If the query is\ninvalid, an error returns. The default value is <code class=\"highlighter-rouge\">false</code>.","optional":true,"default":"nil","nullable":true},{"name":"cache","types":["Boolean"],"description":"Whether to look for the result in the query\ncache. The query cache is a best-effort cache that will be flushed\nwhenever tables in the query are modified. The default value is true.\nFor more information, see <a href=\"https://developers.google.com/bigquery/querying-data\">query\ncaching</a>.","optional":true,"default":"true","nullable":false}],"exceptions":[],"returns":[{"types":["Gcloud::Bigquery::QueryData"],"description":null}]},{"metadata":{"name":"insert_table","description":"","source":"lib/gcloud/bigquery/dataset.rb#L687","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"ensure_connection!","description":"<p>Raise an error unless an active connection is available.</p>","source":"lib/gcloud/bigquery/dataset.rb#L698","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"patch_gapi!","description":"","source":"lib/gcloud/bigquery/dataset.rb#L702","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"ensure_full_data!","description":"<p>Load the complete representation of the dataset if it has been\nonly partially loaded by a request to the API list method.</p>","source":"lib/gcloud/bigquery/dataset.rb#L715","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"reload_gapi!","description":"","source":"lib/gcloud/bigquery/dataset.rb#L719","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"data_complete?","description":"","source":"lib/gcloud/bigquery/dataset.rb#L729","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[{"types":["Boolean"],"description":null}]}]}
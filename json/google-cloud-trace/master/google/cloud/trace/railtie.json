{"id":"google/cloud/trace/railtie","name":"Railtie","title":["Google","Cloud","Trace","Railtie"],"description":"<h1 id=\"rails-integration-for-stackdriver-trace\">Rails integration for Stackdriver Trace</h1>\n\n<p>This Railtie is a drop-in Stackdriver Trace instrumentation plugin\nfor Ruby on Rails applications. If present, it automatically\ninstruments your Rails app to record performance traces and cause them\nto appear on your Stackdriver console.</p>\n\n<h2 id=\"installation\">Installation</h2>\n\n<p>To install this plugin, the gem <code>google-cloud-trace</code> must be in your\nGemfile. You also must add the following line to your <code>application.rb</code>\nfile:</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/trace/rails\"\n</code></pre>\n\n<p>If you include the <code>stackdriver</code> gem in your Gemfile, the above is done\nfor you automatically, and you do not need to edit your\n<code>application.rb</code>.</p>\n\n<h2 id=\"configuration\">Configuration</h2>\n\n<p>The following Rails configuration options are recognized.</p>\n\n<pre><code class=\"language-ruby\">config.google_cloud.use_trace = true | false\n</code></pre>\n\n<p>Normally, tracing is activated when <code>RAILS_ENV</code> is set to <code>production</code>\nand credentials are available. You can override this and enable tracing\nin other environments by setting <code>use_trace</code> explicitly.</p>\n\n<pre><code class=\"language-ruby\">config.google_cloud.keyfile = \"path/to/file\"\n</code></pre>\n\n<p>If your application is running on Google Cloud Platform, it will\nautomatically use credentials available to your project. However, if\nyou are running an application locally or on a different hosting\nprovider, you may provide a path to your credentials file using this\nconfiguration.</p>\n\n<pre><code class=\"language-ruby\">config.google_cloud.project_id = \"my-project-id\"\n</code></pre>\n\n<p>If your application is running on Google Cloud Platform, it will\nautomatically select the project under which it is running. However, if\nyou are running an application locally or on a different hosting\nprovider, or if you want to log traces to a different project than you\nare using to host your application, you may provide the project ID.</p>\n\n<pre><code class=\"language-ruby\">config.google_cloud.trace.notifications = [\"event1\", \"event2\"]\n</code></pre>\n\n<p>By default, this Railtie subscribes to ActiveSupport notifications\nemitted by ActiveRecord queries, rendering, and emailing functions.\nSee DEFAULT_NOTIFICATIONS. If you want to customize the list of\nnotification types, edit the notifications configuration.</p>\n\n<pre><code class=\"language-ruby\">config.google_cloud.trace.max_data_length = 1024\n</code></pre>\n\n<p>The maximum length of span properties recorded with ActiveSupport\nnotification events. Any property value larger than this length is\ntruncated.</p>\n\n<pre><code class=\"language-ruby\">config.google_cloud.trace.capture_stack = true | false\n</code></pre>\n\n<p>Whether to capture the call stack with each trace span. Default is\nfalse.</p>\n\n<h2 id=\"measuring-custom-functionality\">Measuring custom functionality</h2>\n\n<p>To add a custom measurement to a request trace, use the classes\nprovided in this library. Below is an example to get you started.</p>\n\n<pre><code class=\"language-ruby\">class MyController &lt; ApplicationController\n  def index\n    Google::Cloud::Trace.in_span \"Sleeping on the job!\" do\n      sleep rand\n    end\n    render plain: \"Hello World!\"\n  end\nend\n</code></pre>","source":"google-cloud-trace/lib/google/cloud/trace/rails.rb#L116","resources":[],"examples":[],"methods":[{"id":"use_trace?-class","type":"class","name":"use_trace?","title":["Google","Cloud","Trace","Railtie.use_trace?"],"description":"<p>Determine whether to use Stackdriver Trace or not.</p>\n\n<p>Returns true if valid GCP project_id and keyfile are provided and\neither Rails is in “production” environment or\nconfig.google_cloud.use_trace is explicitly true. Otherwise false.</p>","source":"google-cloud-trace/lib/google/cloud/trace/rails.rb#L155","resources":[],"examples":[],"params":[{"name":"config","types":["Rails::Railtie::Configuration"],"description":"The\nRails.application.config","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Boolean"],"description":"Whether to use Stackdriver Trace"}]},{"id":"project_id-class","type":"class","name":"project_id","title":["Google","Cloud","Trace","Railtie.project_id"],"description":"<p>Return the effective project ID for this app, given a Rails config.</p>","source":"google-cloud-trace/lib/google/cloud/trace/rails.rb#L192","resources":[],"examples":[],"params":[{"name":"config","types":["Rails::Railtie::Configuration"],"description":"The\nRails.application.config","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["String"],"description":"The project ID, or nil if not found."}]}]}
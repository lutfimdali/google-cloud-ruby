{"id":"gcloud/search/index","name":"Index","title":["Gcloud","Search","Index"],"description":"<h1 id=\"index\">Index</h1>\n\n<p>An index manages <a data-custom-type=\"gcloud/search/document\">Document</a> instances for retrieval. Indexes cannot be\ncreated, updated, or deleted directly on the server: They are derived from\nthe documents that reference them. You can manage groups of documents by\nputting them into separate indexes.</p>\n\n<p>With an index, you can retrieve documents with\n<a data-custom-type=\"gcloud/search/index\" data-method=\"find-instance\">Gcloud::Search::Index#find</a> and <a data-custom-type=\"gcloud/search/index\" data-method=\"documents-instance\">Gcloud::Search::Index#documents</a>; manage\nthem with <a data-custom-type=\"gcloud/search/index\" data-method=\"document-instance\">Gcloud::Search::Index#document</a>, <a data-custom-type=\"gcloud/search/index\" data-method=\"save-instance\">Gcloud::Search::Index#save</a>,\nand <a data-custom-type=\"gcloud/search/index\" data-method=\"remove-instance\">Gcloud::Search::Index#remove</a>; and perform searches over their fields\nwith <a data-custom-type=\"gcloud/search/index\" data-method=\"search-instance\">Gcloud::Search::Index#search</a>.</p>","source":"lib/gcloud/search/index.rb#L51","resources":[{"title":"Documents and\nIndexes","link":"https://cloud.google.com/search/documents_indexes"}],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\n\nresults = index.search \"dark stormy\"\nresults.each do |result|\n  puts result.doc_id\nend"}],"methods":[{"id":"index_id-instance","type":"instance","name":"index_id","title":["Gcloud","Search","Index#index_id"],"description":"<p>The index identifier. May be defined by the server or by the client.\nMust be unique within the project. It cannot be an empty string. It must\ncontain only visible, printable ASCII characters (ASCII codes 33 through\n126 inclusive) and be no longer than 100 characters. It cannot begin\nwith an exclamation point (<code>!</code>), and it cannot begin and end\nwith double underscores (<code>__</code>).</p>","source":"lib/gcloud/search/index.rb#L75","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"text_fields-instance","type":"instance","name":"text_fields","title":["Gcloud","Search","Index#text_fields"],"description":"<p>The names of fields in which TEXT values are stored.</p>","source":"lib/gcloud/search/index.rb#L83","resources":[{"title":"Index schemas","link":"https://cloud.google.com/search/documents_indexes#index_schemas"}],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"html_fields-instance","type":"instance","name":"html_fields","title":["Gcloud","Search","Index#html_fields"],"description":"<p>The names of fields in which HTML values are stored.</p>","source":"lib/gcloud/search/index.rb#L92","resources":[{"title":"Index schemas","link":"https://cloud.google.com/search/documents_indexes#index_schemas"}],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"atom_fields-instance","type":"instance","name":"atom_fields","title":["Gcloud","Search","Index#atom_fields"],"description":"<p>The names of fields in which ATOM values are stored.</p>","source":"lib/gcloud/search/index.rb#L101","resources":[{"title":"Index schemas","link":"https://cloud.google.com/search/documents_indexes#index_schemas"}],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"datetime_fields-instance","type":"instance","name":"datetime_fields","title":["Gcloud","Search","Index#datetime_fields"],"description":"<p>The names of fields in which DATE values are stored.</p>","source":"lib/gcloud/search/index.rb#L110","resources":[{"title":"Index schemas","link":"https://cloud.google.com/search/documents_indexes#index_schemas"}],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"number_fields-instance","type":"instance","name":"number_fields","title":["Gcloud","Search","Index#number_fields"],"description":"<p>The names of fields in which NUMBER values are stored.</p>","source":"lib/gcloud/search/index.rb#L119","resources":[{"title":"Index schemas","link":"https://cloud.google.com/search/documents_indexes#index_schemas"}],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"geo_fields-instance","type":"instance","name":"geo_fields","title":["Gcloud","Search","Index#geo_fields"],"description":"<p>The names of fields in which GEO values are stored.</p>","source":"lib/gcloud/search/index.rb#L128","resources":[{"title":"Index schemas","link":"https://cloud.google.com/search/documents_indexes#index_schemas"}],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"field_names-instance","type":"instance","name":"field_names","title":["Gcloud","Search","Index#field_names"],"description":"<p>The names of all the fields that are stored on the index.</p>","source":"lib/gcloud/search/index.rb#L135","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"field_types_for-instance","type":"instance","name":"field_types_for","title":["Gcloud","Search","Index#field_types_for"],"description":"<p>The field value types that are stored on the field name.</p>","source":"lib/gcloud/search/index.rb#L142","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"find-instance","type":"instance","name":"find","title":["Gcloud","Search","Index#find"],"description":"<p>Retrieves an existing document by id.</p>","source":"lib/gcloud/search/index.rb#L171","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocument = index.find \"product-sku-000001\"\nputs document.doc_id"}],"params":[{"name":"doc_id","types":["String","Gcloud::Search::Document"],"description":"The id of a document or\na Document instance.","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"gcloud/search/document\">Gcloud::Search::Document</a>","nil"],"description":"Returns <code>nil</code> if the document\ndoes not exist"}]},{"id":"document-instance","type":"instance","name":"document","title":["Gcloud","Search","Index#document"],"description":"<p>Helper for creating a new Document instance. The returned instance is\nlocal: It is either not yet saved to the service (see\n<a data-custom-type=\"gcloud/search/index\" data-method=\"save-instance\">Gcloud::Search::Index#save</a>), or if it has been given the id of an\nexisting document, it is not yet populated with the documentâ€™s data (see\n<a data-custom-type=\"gcloud/search/index\" data-method=\"find-instance\">Gcloud::Search::Index#find</a>).</p>","source":"lib/gcloud/search/index.rb#L230","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocument = index.document \"product-sku-000001\"\ndocument.doc_id #=> nil\ndocument.rank #=> nil"},{"caption":"<p>To check if an index already contains a document:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocument = index.document \"product-sku-000001\"\ndocument = index.find document # returns nil if not present"}],"params":[{"name":"doc_id","types":["String","nil"],"description":"An optional unique ID for the new document.\nWhen the document is saved, this value must contain only visible,\nprintable ASCII characters (ASCII codes 33 through 126 inclusive) and\nbe no longer than 500 characters. It cannot begin with an exclamation\npoint (<code>!</code>), and it cannot begin and end with double\nunderscores (<code>__</code>).","optional":true,"default":"nil","nullable":true},{"name":"rank","types":["Integer","nil"],"description":"An optional rank for the new document. An\ninteger which determines the default ordering of documents returned\nfrom a search. It is a bad idea to assign the same rank to many\ndocuments, and the same rank should never be assigned to more than\n10,000 documents. By default (when it is not specified or set to 0),\nit is set at the time the document is saved to the number of seconds\nsince January 1, 2011. The rank can be used in the <code>expressions</code>,\n<code>order</code>, and <code>fields</code> options in <a data-custom-type=\"gcloud/search/index\" data-method=\"search-instance\">Gcloud::Search::Index#search</a>, where\nit should referenced as <code>rank</code>.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"gcloud/search/document\">Gcloud::Search::Document</a>"],"description":""}]},{"id":"documents-instance","type":"instance","name":"documents","title":["Gcloud","Search","Index#documents"],"description":"<p>Retrieves the list of documents belonging to the index.</p>","source":"lib/gcloud/search/index.rb#L275","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocuments = index.documents\ndocuments.each do |index|\n  puts index.index_id\nend"},{"caption":"<p>With pagination: (See <a data-custom-type=\"gcloud/search/document/list\">Gcloud::Search::Document::List</a>)</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocuments = index.documents\nloop do\n  documents.each do |index|\n    puts index.index_id\n  end\n  break unless documents.next?\n  documents = documents.next\nend"}],"params":[{"name":"token","types":["String"],"description":"A previously-returned page token representing part\nof the larger set of results to view.","optional":true,"default":"nil","nullable":true},{"name":"max","types":["Integer"],"description":"Maximum number of documents to return. The default\nis <code>100</code>.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Array&lt;<a data-custom-type=\"gcloud/search/document\">Gcloud::Search::Document</a>&gt;"],"description":"See\n<a data-custom-type=\"gcloud/search/document/list\">Gcloud::Search::Document::List</a>)"}]},{"id":"save-instance","type":"instance","name":"save","title":["Gcloud","Search","Index#save"],"description":"<p>Saves a new or existing document to the index. If the document instance\nis new and has been given an id (see <a data-custom-type=\"gcloud/search/index\" data-method=\"document-instance\">Gcloud::Search::Index#document</a>),\nit will replace an existing document in the index that has the same\nunique id.</p>","source":"lib/gcloud/search/index.rb#L310","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocument = index.document \"product-sku-000001\"\ndocument.doc_id #=> nil\ndocument.rank #=> nil\n\ndocument = index.save document\ndocument.doc_id #=> \"-2486020449015432113\"\ndocument.rank #=> 154223228"}],"params":[{"name":"document","types":["Gcloud::Search::Document"],"description":"A Document instance, either\nnew (see <a data-custom-type=\"gcloud/search/index\" data-method=\"document-instance\">Gcloud::Search::Index#document</a>) or existing (see\n<a data-custom-type=\"gcloud/search/index\" data-method=\"find-instance\">Gcloud::Search::Index#find</a>).","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"gcloud/search/document\">Gcloud::Search::Document</a>"],"description":""}]},{"id":"remove-instance","type":"instance","name":"remove","title":["Gcloud","Search","Index#remove"],"description":"<p>Permanently deletes the document from the index.</p>","source":"lib/gcloud/search/index.rb#L338","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\nindex.remove \"product-sku-000001\""}],"params":[{"name":"doc_id","types":["String"],"description":"The id of the document.","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Boolean"],"description":"<code>true</code> if successful"}]},{"id":"delete-instance","type":"instance","name":"delete","title":["Gcloud","Search","Index#delete"],"description":"<p>Permanently deletes the index by deleting its documents. (Indexes cannot\nbe created, updated, or deleted directly on the server: They are derived\nfrom the documents that reference them.)</p>","source":"lib/gcloud/search/index.rb#L372","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\nindex.delete"},{"caption":"<p>Deleting an index containing documents with the <code>force</code> option:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\nindex.delete force: true"}],"params":[{"name":"force","types":["Boolean"],"description":"If <code>true</code>, ensures the deletion of the index by\nfirst deleting all documents. If <code>false</code> and the index contains\ndocuments, the request will fail. Default is <code>false</code>.","optional":true,"default":"false","nullable":false}],"exceptions":[],"returns":[]},{"id":"search-instance","type":"instance","name":"search","title":["Gcloud","Search","Index#search"],"description":"<p>Runs a search against the documents in the index using the provided\nquery.</p>\n\n<p>By default, Result objects are sorted by document rank. For more information\nsee the <a href=\"https://cloud.google.com/search/reference/rest/v1/projects/indexes/documents#resource_representation.google.cloudsearch.v1.Document.rank\">REST API documentation for Document.rank</a>.</p>\n\n<p>You can specify how to sort results with the <code>order</code> option. In the\nexample below, the <code>-</code> character before <code>avg_review</code> means\nthat results will be sorted in ascending order by <code>published</code> and then\nin descending order by <code>avg_review</code>. You can add computed fields with\nthe <code>expressions</code> option, and limit the fields that are returned with\nthe <code>fields</code> option.</p>","source":"lib/gcloud/search/index.rb#L539","resources":[{"title":"The REST API documentation for indexes.search","link":"https://cloud.google.com/search/reference/rest/v1/projects/indexes/search"}],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\n\nresults = index.search \"dark stormy\"\nresults.each do |result|\n  puts result.doc_id\nend"},{"caption":"<p>With pagination: (See <a data-custom-type=\"gcloud/search/result/list\">Gcloud::Search::Result::List</a>)</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\n\nresults = index.results\nloop do\n  results.each do |result|\n    puts result.doc_id\n  end\n  break unless results.next?\n  results = results.next\nend"},{"caption":"<p>With the <code>order</code> option:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\n\nresults = index.search \"dark stormy\", order: \"published, avg_review desc\"\ndocuments = index.search query # API call"},{"caption":"<p>With the <code>fields</code> option:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\nresults = index.search \"cotton T-shirt\",\n                       expressions: { total_price: \"(price + tax)\" },\n                       fields: [\"name\", \"total_price\", \"highlight\"]"},{"caption":"<p>Just as in documents, data is accessible via <a data-custom-type=\"gcloud/search/fields\">Fields</a> methods:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\ndocument = index.find \"product-sku-000001\"\nresults = index.search \"cotton T-shirt\"\nvalues = results[0][\"description\"]\n\nvalues[0] #=> \"100% organic cotton ruby gem T-shirt\"\nvalues[0].type #=> :text\nvalues[0].lang #=> \"en\"\nvalues[1] #=> \"<p>100% organic cotton ruby gem T-shirt</p>\"\nvalues[1].type #=> :html\nvalues[1].lang #=> \"en\""}],"params":[{"name":"query","types":["String"],"description":"The query string in search query syntax. If the\nquery is <code>nil</code> or empty, all documents are returned. For more\ninformation see <a href=\"https://cloud.google.com/search/query\">Query\nStrings</a>.","optional":false,"nullable":false},{"name":"expressions","types":["Hash"],"description":"Customized expressions used in <code>order</code> or\n<code>fields</code>. The expression can contain fields in Document, the built-in\nfields ( <code>rank</code>, the document <code>rank</code>, and <code>score</code> if scoring is\nenabled) and fields defined in <code>expressions</code>. All field expressions\nexpressed as a <code>Hash</code> with the keys as the <code>name</code> and the values as\nthe <code>expression</code>. The expression value can be a combination of\nsupported functions encoded in the string. Expressions involving\nnumber fields can use the arithmetical operators (+, -, *, /) and the\nbuilt-in numeric functions (<code>max</code>, <code>min</code>, <code>pow</code>, <code>count</code>, <code>log</code>,\n<code>abs</code>). Expressions involving geopoint fields can use the <code>geopoint</code>\nand <code>distance</code> functions. Expressions for text and html fields can use\nthe <code>snippet</code> function.","optional":true,"default":"nil","nullable":true},{"name":"matched_count_accuracy","types":["Integer"],"description":"Minimum accuracy requirement for\n<a data-custom-type=\"gcloud/search/result/list\" data-method=\"matched_count-instance\">Result::List#matched_count</a>. If specified, <code>matched_count</code> will be\naccurate to at least that number. For example, when set to 100, any\n<code>matched_count &lt;= 100</code> is accurate. This option may add\nconsiderable latency/expense. By default (when it is not specified or\nset to 0), the accuracy is the same as <code>max</code>.","optional":true,"default":"nil","nullable":true},{"name":"offset","types":["Integer"],"description":"Used to advance pagination to an arbitrary\nresult, independent of the previous results. Offsets are an\ninefficient alternative to using <code>token</code>. (Both cannot be both set.)\nThe default is 0.","optional":true,"default":"nil","nullable":true},{"name":"order","types":["String"],"description":"A comma-separated list of fields for sorting on\nthe search result, including fields from Document, the built-in fields\n(<code>rank</code> and <code>score</code>), and fields defined in expressions. The default\nsorting order is ascending. To specify descending order for a field, a\nsuffix <code>\" desc\"</code> should be appended to the field name. For\nexample: <code>orderBy=\"foo desc,bar\"</code>. The default value for\ntext sort is the empty string, and the default value for numeric sort\nis 0. If not specified, the search results are automatically sorted by\ndescending <code>rank</code>. Sorting by ascending <code>rank</code> is not allowed.","optional":true,"default":"nil","nullable":true},{"name":"fields","types":["String","Array<String>"],"description":"The fields to return in the\n<a data-custom-type=\"gcloud/search/result\">Search::Result</a> objects. These can be fields from <a data-custom-type=\"gcloud/search/document\">Document</a>, the\nbuilt-in fields <code>rank</code> and <code>score</code>, and fields defined in expressions.\nThe default is to return all fields.","optional":true,"default":"nil","nullable":true},{"name":"scorer","types":["String","Symbol"],"description":"The scoring function to invoke on a\nsearch result for this query. If scorer is not set, scoring is\ndisabled and <code>score</code> is 0 for all documents in the search result. To\nenable document relevancy score based on term frequency, set <code>scorer</code>\nto <code>:generic</code>.","optional":true,"default":"nil","nullable":true},{"name":"scorer_size","types":["Integer"],"description":"Maximum number of top retrieved results to\nscore. It is valid only when <code>scorer</code> is set. The default is 100.","optional":true,"default":"nil","nullable":true},{"name":"token","types":["String"],"description":"A previously-returned page token representing part\nof the larger set\nof results to view.","optional":true,"default":"nil","nullable":true},{"name":"max","types":["Integer"],"description":"Maximum number of results to return per page.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Array&lt;<a data-custom-type=\"gcloud/search/result\">Gcloud::Search::Result</a>&gt;"],"description":"(See\n<a data-custom-type=\"gcloud/search/result/list\">Gcloud::Search::Result::List</a>)"}]}]}
{"id":"gcloud/resourcemanager","name":"ResourceManager","title":["Gcloud","ResourceManager"],"description":"<h1 id=\"google-cloud-resource-manager\">Google Cloud Resource Manager</h1>\n\n<p>The Resource Manager API provides methods that you can use to\nprogrammatically manage your projects in the Google Cloud Platform. You may\nbe familiar with managing projects in the <a href=\"https://developers.google.com/console/help/new/\">Developers\nConsole</a>. With this API you\ncan do the following:</p>\n\n<ul>\n  <li>Get a list of all projects associated with an account</li>\n  <li>Create new projects</li>\n  <li>Update existing projects</li>\n  <li>Delete projects</li>\n  <li>Undelete, or recover, projects that you don’t want to delete</li>\n</ul>\n\n<p>The Resource Manager API is a Beta release and is not covered by any SLA or\ndeprecation policy and may be subject to backward-incompatible changes.</p>\n\n<h2 id=\"accessing-the-service\">Accessing the Service</h2>\n\n<p>Currently, the full functionality of the Resource Manager API is available\nonly to whitelisted users. (Contact your account manager or a member of the\nGoogle Cloud sales team if you are interested in access.) Read-only methods\nsuch as ResourceManager::Manager#projects and\nResourceManager::Manager#project are accessible to any user who enables the\nResource Manager API in the <a href=\"https://console.developers.google.com\">Developers\nConsole</a>.</p>\n\n<h2 id=\"authentication\">Authentication</h2>\n\n<p>The Resource Manager API currently requires authentication of a <a href=\"https://developers.google.com/identity/protocols/OAuth2\">User\nAccount</a>, and\ncannot currently be accessed with a <a href=\"https://developers.google.com/identity/protocols/OAuth2ServiceAccount\">Service\nAccount</a>.\nTo use a User Account install the <a href=\"http://cloud.google.com/sdk\">Google Cloud\nSDK</a> and authenticate with the following:</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code>$ gcloud auth login\n</code></pre>\n</div>\n\n<p>Also make sure all <code class=\"highlighter-rouge\">GCLOUD</code> environment variables are cleared of any service\naccounts. Then gcloud will be able to detect the user authentication and\nconnect with those credentials.</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code><span class=\"nb\">require</span> <span class=\"s2\">\"gcloud\"</span>\n\n<span class=\"n\">gcloud</span> <span class=\"o\">=</span> <span class=\"no\">Gcloud</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">resource_manager</span> <span class=\"o\">=</span> <span class=\"n\">gcloud</span><span class=\"p\">.</span><span class=\"nf\">resource_manager</span>\n</code></pre>\n</div>\n\n<h2 id=\"listing-projects\">Listing Projects</h2>\n\n<p>Project is a collection of settings, credentials, and metadata about the\napplication or applications you’re working on. You can retrieve and inspect\nall projects that you have permissions to. (See Manager#projects)</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code><span class=\"nb\">require</span> <span class=\"s2\">\"gcloud\"</span>\n\n<span class=\"n\">gcloud</span> <span class=\"o\">=</span> <span class=\"no\">Gcloud</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">resource_manager</span> <span class=\"o\">=</span> <span class=\"n\">gcloud</span><span class=\"p\">.</span><span class=\"nf\">resource_manager</span>\n<span class=\"n\">resource_manager</span><span class=\"p\">.</span><span class=\"nf\">projects</span><span class=\"p\">.</span><span class=\"nf\">each</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">project</span><span class=\"o\">|</span>\n  <span class=\"nb\">puts</span> <span class=\"n\">projects</span><span class=\"p\">.</span><span class=\"nf\">project_id</span>\n<span class=\"k\">end</span>\n</code></pre>\n</div>\n\n<h2 id=\"managing-projects-with-labels\">Managing Projects with Labels</h2>\n\n<p>Labels can be added to or removed from projects. (See Project#labels)</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code><span class=\"nb\">require</span> <span class=\"s2\">\"gcloud\"</span>\n\n<span class=\"n\">gcloud</span> <span class=\"o\">=</span> <span class=\"no\">Gcloud</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">resource_manager</span> <span class=\"o\">=</span> <span class=\"n\">gcloud</span><span class=\"p\">.</span><span class=\"nf\">resource_manager</span>\n<span class=\"n\">project</span> <span class=\"o\">=</span> <span class=\"n\">resource_manager</span><span class=\"p\">.</span><span class=\"nf\">project</span> <span class=\"s2\">\"tokyo-rain-123\"</span>\n<span class=\"c1\"># Label the project as production</span>\n<span class=\"n\">project</span><span class=\"p\">.</span><span class=\"nf\">update</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"nb\">p</span><span class=\"o\">|</span>\n  <span class=\"nb\">p</span><span class=\"p\">.</span><span class=\"nf\">labels</span><span class=\"p\">[</span><span class=\"s2\">\"env\"</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s2\">\"production\"</span>\n<span class=\"k\">end</span>\n</code></pre>\n</div>\n\n<p>Projects can then be filtered by labels. (See Manager#projects)</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code><span class=\"nb\">require</span> <span class=\"s2\">\"gcloud\"</span>\n\n<span class=\"n\">gcloud</span> <span class=\"o\">=</span> <span class=\"no\">Gcloud</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">resource_manager</span> <span class=\"o\">=</span> <span class=\"n\">gcloud</span><span class=\"p\">.</span><span class=\"nf\">resource_manager</span>\n<span class=\"c1\"># Find only the productions projects</span>\n<span class=\"n\">projects</span> <span class=\"o\">=</span> <span class=\"n\">resource_manager</span><span class=\"p\">.</span><span class=\"nf\">projects</span> <span class=\"ss\">filter: </span><span class=\"s2\">\"labels.env:production\"</span>\n<span class=\"n\">projects</span><span class=\"p\">.</span><span class=\"nf\">each</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">project</span><span class=\"o\">|</span>\n  <span class=\"nb\">puts</span> <span class=\"n\">project</span><span class=\"p\">.</span><span class=\"nf\">project_id</span>\n<span class=\"k\">end</span>\n</code></pre>\n</div>\n\n<h2 id=\"creating-a-project\">Creating a Project</h2>\n\n<p>You can also use the API to create new projects. (See\nManager#create_project)</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code><span class=\"nb\">require</span> <span class=\"s2\">\"gcloud\"</span>\n\n<span class=\"n\">gcloud</span> <span class=\"o\">=</span> <span class=\"no\">Gcloud</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">resource_manager</span> <span class=\"o\">=</span> <span class=\"n\">gcloud</span><span class=\"p\">.</span><span class=\"nf\">resource_manager</span>\n<span class=\"n\">project</span> <span class=\"o\">=</span> <span class=\"n\">resource_manager</span><span class=\"p\">.</span><span class=\"nf\">create_project</span> <span class=\"s2\">\"tokyo-rain-123\"</span><span class=\"p\">,</span>\n                                          <span class=\"ss\">name: </span><span class=\"s2\">\"Todos Development\"</span><span class=\"p\">,</span>\n                                          <span class=\"ss\">labels: </span><span class=\"p\">{</span><span class=\"ss\">env: :development</span><span class=\"p\">}</span>\n</code></pre>\n</div>\n\n<h2 id=\"deleting-a-project\">Deleting a Project</h2>\n\n<p>You can delete projects when they are no longer needed. (See\nManager#delete and Project#delete)</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code><span class=\"nb\">require</span> <span class=\"s2\">\"gcloud\"</span>\n\n<span class=\"n\">gcloud</span> <span class=\"o\">=</span> <span class=\"no\">Gcloud</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">resource_manager</span> <span class=\"o\">=</span> <span class=\"n\">gcloud</span><span class=\"p\">.</span><span class=\"nf\">resource_manager</span>\n<span class=\"n\">resource_manager</span><span class=\"p\">.</span><span class=\"nf\">delete</span> <span class=\"s2\">\"tokyo-rain-123\"</span>\n</code></pre>\n</div>\n\n<h2 id=\"undeleting-a-project\">Undeleting a Project</h2>\n\n<p>You can also restore a deleted project within the waiting period that\nstarts when the project was deleted. Restoring a project returns it to the\nstate it was in prior to being deleted. (See Manager#undelete and\nProject#undelete)</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code><span class=\"nb\">require</span> <span class=\"s2\">\"gcloud\"</span>\n\n<span class=\"n\">gcloud</span> <span class=\"o\">=</span> <span class=\"no\">Gcloud</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">resource_manager</span> <span class=\"o\">=</span> <span class=\"n\">gcloud</span><span class=\"p\">.</span><span class=\"nf\">resource_manager</span>\n<span class=\"n\">resource_manager</span><span class=\"p\">.</span><span class=\"nf\">undelete</span> <span class=\"s2\">\"tokyo-rain-123\"</span>\n</code></pre>\n</div>\n\n<h2 id=\"managing-iam-policies\">Managing IAM Policies</h2>\n\n<p>Google Cloud Identity and Access Management (<a href=\"https://cloud.google.com/iam/\">Cloud\nIAM</a>) access control policies can be managed\non projects. These policies allow project owners to manage <em>who</em> (identity)\nhas access to <em>what</em> (role). See <a href=\"https://cloud.google.com/iam/docs/overview\">Cloud IAM\nOverview</a> for more information.</p>\n\n<p>A project’s access control policy can be retrieved. (See Project#policy)</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code><span class=\"nb\">require</span> <span class=\"s2\">\"gcloud\"</span>\n\n<span class=\"n\">gcloud</span> <span class=\"o\">=</span> <span class=\"no\">Gcloud</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">resource_manager</span> <span class=\"o\">=</span> <span class=\"n\">gcloud</span><span class=\"p\">.</span><span class=\"nf\">resource_manager</span>\n<span class=\"n\">project</span> <span class=\"o\">=</span> <span class=\"n\">resource_manager</span><span class=\"p\">.</span><span class=\"nf\">project</span> <span class=\"s2\">\"tokyo-rain-123\"</span>\n<span class=\"n\">policy</span> <span class=\"o\">=</span> <span class=\"n\">project</span><span class=\"p\">.</span><span class=\"nf\">policy</span>\n</code></pre>\n</div>\n\n<p>A project’s access control policy can also be set. (See Project#policy=)</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code><span class=\"nb\">require</span> <span class=\"s2\">\"gcloud\"</span>\n\n<span class=\"n\">gcloud</span> <span class=\"o\">=</span> <span class=\"no\">Gcloud</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">resource_manager</span> <span class=\"o\">=</span> <span class=\"n\">gcloud</span><span class=\"p\">.</span><span class=\"nf\">resource_manager</span>\n<span class=\"n\">project</span> <span class=\"o\">=</span> <span class=\"n\">resource_manager</span><span class=\"p\">.</span><span class=\"nf\">project</span> <span class=\"s2\">\"tokyo-rain-123\"</span>\n\n<span class=\"n\">viewer_policy</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n  <span class=\"s2\">\"bindings\"</span> <span class=\"o\">=&gt;</span> <span class=\"p\">[{</span>\n    <span class=\"s2\">\"role\"</span> <span class=\"o\">=&gt;</span> <span class=\"s2\">\"roles/viewer\"</span><span class=\"p\">,</span>\n    <span class=\"s2\">\"members\"</span> <span class=\"o\">=&gt;</span> <span class=\"p\">[</span><span class=\"s2\">\"serviceAccount:your-service-account\"</span><span class=\"p\">]</span>\n  <span class=\"p\">}]</span>\n<span class=\"p\">}</span>\n<span class=\"n\">project</span><span class=\"p\">.</span><span class=\"nf\">policy</span> <span class=\"o\">=</span> <span class=\"n\">viewer_policy</span>\n</code></pre>\n</div>\n\n<p>And permissions can be tested on a project. (See Project#test_permissions)</p>\n\n<div class=\"highlighter-rouge\"><pre class=\"ruby\"><code><span class=\"nb\">require</span> <span class=\"s2\">\"gcloud\"</span>\n\n<span class=\"n\">gcloud</span> <span class=\"o\">=</span> <span class=\"no\">Gcloud</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">resource_manager</span> <span class=\"o\">=</span> <span class=\"n\">gcloud</span><span class=\"p\">.</span><span class=\"nf\">resource_manager</span>\n<span class=\"n\">project</span> <span class=\"o\">=</span> <span class=\"n\">resource_manager</span><span class=\"p\">.</span><span class=\"nf\">project</span> <span class=\"s2\">\"tokyo-rain-123\"</span>\n<span class=\"n\">perms</span> <span class=\"o\">=</span> <span class=\"n\">project</span><span class=\"p\">.</span><span class=\"nf\">test_permissions</span> <span class=\"s2\">\"resourcemanager.projects.get\"</span><span class=\"p\">,</span>\n                                 <span class=\"s2\">\"resourcemanager.projects.delete\"</span>\n<span class=\"n\">perms</span><span class=\"p\">.</span><span class=\"nf\">include?</span> <span class=\"s2\">\"resourcemanager.projects.get\"</span>    <span class=\"c1\">#=&gt; true</span>\n<span class=\"n\">perms</span><span class=\"p\">.</span><span class=\"nf\">include?</span> <span class=\"s2\">\"resourcemanager.projects.delete\"</span> <span class=\"c1\">#=&gt; false</span>\n</code></pre>\n</div>\n\n<p>For more information about using access control policies see <a href=\"https://cloud.google.com/iam/docs/managing-policies\">Managing\nPolicies</a>.</p>","source":"lib/gcloud/resource_manager.rb#L250","resources":[],"examples":[],"methods":[]}
{"id":"index","metadata":{"name":"Index","description":"<h1 id=\"index\">Index</h1>\n\n<p>An index manages {Document} instances for retrieval. Indexes cannot be\ncreated, updated, or deleted directly on the server: They are derived from\nthe documents that reference them. You can manage groups of documents by\nputting them into separate indexes.</p>\n\n<p>With an index, you can retrieve documents with {#find} and {#documents};\nmanage them with {#document}, {#save}, and {#remove}; and perform searches\nover their fields with {#search}.</p>","source":"lib/gcloud/search/index.rb#L49","resources":[{"href":"https://cloud.google.com/search/documents_indexes","title":"Documents and\nIndexes"}],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\n\nresults = index.search \"dark stormy\"\nresults.each do |result|\n  puts result.doc_id\nend"}]},"methods":[{"metadata":{"name":"index_id","description":"<p>The index identifier. May be defined by the server or by the client.\nMust be unique within the project. It cannot be an empty string. It must\ncontain only visible, printable ASCII characters (ASCII codes 33 through\n126 inclusive) and be no longer than 100 characters. It cannot begin\nwith an exclamation point (<code>!</code>), and it cannot begin and end\nwith double underscores (<code>__</code>).</p>","source":"lib/gcloud/search/index.rb#L73","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"text_fields","description":"<p>The names of fields in which TEXT values are stored.</p>","source":"lib/gcloud/search/index.rb#L81","resources":[{"href":"https://cloud.google.com/search/documents_indexes#index_schemas","title":"Index schemas"}],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"html_fields","description":"<p>The names of fields in which HTML values are stored.</p>","source":"lib/gcloud/search/index.rb#L90","resources":[{"href":"https://cloud.google.com/search/documents_indexes#index_schemas","title":"Index schemas"}],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"atom_fields","description":"<p>The names of fields in which ATOM values are stored.</p>","source":"lib/gcloud/search/index.rb#L99","resources":[{"href":"https://cloud.google.com/search/documents_indexes#index_schemas","title":"Index schemas"}],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"datetime_fields","description":"<p>The names of fields in which DATE values are stored.</p>","source":"lib/gcloud/search/index.rb#L108","resources":[{"href":"https://cloud.google.com/search/documents_indexes#index_schemas","title":"Index schemas"}],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"number_fields","description":"<p>The names of fields in which NUMBER values are stored.</p>","source":"lib/gcloud/search/index.rb#L117","resources":[{"href":"https://cloud.google.com/search/documents_indexes#index_schemas","title":"Index schemas"}],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"geo_fields","description":"<p>The names of fields in which GEO values are stored.</p>","source":"lib/gcloud/search/index.rb#L126","resources":[{"href":"https://cloud.google.com/search/documents_indexes#index_schemas","title":"Index schemas"}],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"field_names","description":"<p>The names of all the fields that are stored on the index.</p>","source":"lib/gcloud/search/index.rb#L133","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"field_types_for","description":"<p>The field value types that are stored on the field name.</p>","source":"lib/gcloud/search/index.rb#L140","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"find","description":"<p>Retrieves an existing document by id.</p>","source":"lib/gcloud/search/index.rb#L169","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocument = index.find \"product-sku-000001\"\nputs document.doc_id"}]},"params":[{"name":"doc_id","types":["String","Gcloud::Search::Document"],"description":"The id of a document or\na Document instance.","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Gcloud::Search::Document","nil"],"description":"Returns <code class=\"highlighter-rouge\">nil</code> if the document\ndoes not exist"}]},{"metadata":{"name":"document","description":"<p>Helper for creating a new Document instance. The returned instance is\nlocal: It is either not yet saved to the service (see {#save}), or if it\nhas been given the id of an existing document, it is not yet populated\nwith the documentâ€™s data (see {#find}).</p>","source":"lib/gcloud/search/index.rb#L228","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocument = index.document \"product-sku-000001\"\ndocument.doc_id #=> nil\ndocument.rank #=> nil"},{"caption":"To check if an index already contains a document:","code":"\nrequire \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocument = index.document \"product-sku-000001\"\ndocument = index.find document # returns nil if not present"}]},"params":[{"name":"doc_id","types":["String","nil"],"description":"An optional unique ID for the new document.\nWhen the document is saved, this value must contain only visible,\nprintable ASCII characters (ASCII codes 33 through 126 inclusive) and\nbe no longer than 500 characters. It cannot begin with an exclamation\npoint (<code>!</code>), and it cannot begin and end with double\nunderscores (<code>__</code>).","optional":true,"default":"nil","nullable":true},{"name":"rank","types":["Integer","nil"],"description":"An optional rank for the new document. An\ninteger which determines the default ordering of documents returned\nfrom a search. It is a bad idea to assign the same rank to many\ndocuments, and the same rank should never be assigned to more than\n10,000 documents. By default (when it is not specified or set to 0),\nit is set at the time the document is saved to the number of seconds\nsince January 1, 2011. The rank can be used in the <code class=\"highlighter-rouge\">expressions</code>,\n<code class=\"highlighter-rouge\">order</code>, and <code class=\"highlighter-rouge\">fields</code> options in {#search}, where it should referenced\nas <code class=\"highlighter-rouge\">rank</code>.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Gcloud::Search::Document"],"description":null}]},{"metadata":{"name":"documents","description":"<p>Retrieves the list of documents belonging to the index.</p>","source":"lib/gcloud/search/index.rb#L274","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocuments = index.documents\ndocuments.each do |index|\n  puts index.index_id\nend"},{"caption":"With pagination: (See {Gcloud::Search::Document::List})","code":"\nrequire \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocuments = index.documents\nloop do\n  documents.each do |index|\n    puts index.index_id\n  end\n  break unless documents.next?\n  documents = documents.next\nend"}]},"params":[{"name":"token","types":["String"],"description":"A previously-returned page token representing part\nof the larger set of results to view.","optional":true,"default":"nil","nullable":true},{"name":"max","types":["Integer"],"description":"Maximum number of documents to return. The default\nis <code class=\"highlighter-rouge\">100</code>.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Array<Gcloud::Search::Document>"],"description":"See\n{Gcloud::Search::Document::List})"}]},{"metadata":{"name":"save","description":"<p>Saves a new or existing document to the index. If the document instance\nis new and has been given an id (see {#document}), it will replace an\nexisting document in the index that has the same unique id.</p>","source":"lib/gcloud/search/index.rb#L307","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\ndocument = index.document \"product-sku-000001\"\ndocument.doc_id #=> nil\ndocument.rank #=> nil\n\ndocument = index.save document\ndocument.doc_id #=> \"-2486020449015432113\"\ndocument.rank #=> 154223228"}]},"params":[{"name":"document","types":["Gcloud::Search::Document"],"description":"A Document instance, either\nnew (see {#document}) or existing (see {#find}).","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Gcloud::Search::Document"],"description":null}]},{"metadata":{"name":"remove","description":"<p>Permanently deletes the document from the index.</p>","source":"lib/gcloud/search/index.rb#L335","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\nindex.remove \"product-sku-000001\""}]},"params":[{"name":"doc_id","types":["String"],"description":"The id of the document.","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Boolean"],"description":"<code class=\"highlighter-rouge\">true</code> if successful"}]},{"metadata":{"name":"delete","description":"<p>Permanently deletes the index by deleting its documents. (Indexes cannot\nbe created, updated, or deleted directly on the server: They are derived\nfrom the documents that reference them.)</p>","source":"lib/gcloud/search/index.rb#L369","resources":[],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\nindex.delete"},{"caption":"Deleting an index containing documents with the <code class=\"highlighter-rouge\">force</code> option:","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\nindex.delete force: true"}]},"params":[{"name":"force","types":["Boolean"],"description":"If <code class=\"highlighter-rouge\">true</code>, ensures the deletion of the index by\nfirst deleting all documents. If <code class=\"highlighter-rouge\">false</code> and the index contains\ndocuments, the request will fail. Default is <code class=\"highlighter-rouge\">false</code>.","optional":true,"default":"false","nullable":false}],"exceptions":[],"returns":[]},{"metadata":{"name":"search","description":"<p>Runs a search against the documents in the index using the provided\nquery.</p>\n\n<p>By default, Result objects are sorted by document rank. For more information\nsee the <a href=\"https://cloud.google.com/search/reference/rest/v1/projects/indexes/documents#resource_representation.google.cloudsearch.v1.Document.rank\">REST API documentation for Document.rank</a>.</p>\n\n<p>You can specify how to sort results with the <code class=\"highlighter-rouge\">order</code> option. In the\nexample below, the <code>-</code> character before <code class=\"highlighter-rouge\">avg_review</code> means\nthat results will be sorted in ascending order by <code class=\"highlighter-rouge\">published</code> and then\nin descending order by <code class=\"highlighter-rouge\">avg_review</code>. You can add computed fields with\nthe <code class=\"highlighter-rouge\">expressions</code> option, and limit the fields that are returned with\nthe <code class=\"highlighter-rouge\">fields</code> option.</p>","source":"lib/gcloud/search/index.rb#L539","resources":[{"href":"https://cloud.google.com/search/reference/rest/v1/projects/indexes/search","title":"The REST API documentation for indexes.search"}],"examples":[{"caption":null,"code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\n\nresults = index.search \"dark stormy\"\nresults.each do |result|\n  puts result.doc_id\nend"},{"caption":"With pagination: (See {Gcloud::Search::Result::List})","code":"\nrequire \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\n\nresults = index.results\nloop do\n  results.each do |result|\n    puts result.doc_id\n  end\n  break unless results.next?\n  results = results.next\nend"},{"caption":"With the <code class=\"highlighter-rouge\">order</code> option:","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"books\"\n\nresults = index.search \"dark stormy\", order: \"published, avg_review desc\"\ndocuments = index.search query # API call"},{"caption":"With the <code class=\"highlighter-rouge\">fields</code> option:","code":"\nrequire \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\n\nresults = index.search \"cotton T-shirt\",\n                       expressions: { total_price: \"(price + tax)\" },\n                       fields: [\"name\", \"total_price\", \"highlight\"]"},{"caption":"Just as in documents, data is accessible via {Fields} methods:","code":"\nrequire \"gcloud\"\n\ngcloud = Gcloud.new\nsearch = gcloud.search\nindex = search.index \"products\"\ndocument = index.find \"product-sku-000001\"\nresults = index.search \"cotton T-shirt\"\nvalues = results[0][\"description\"]\n\nvalues[0] #=> \"100% organic cotton ruby gem T-shirt\"\nvalues[0].type #=> :text\nvalues[0].lang #=> \"en\"\nvalues[1] #=> \"<p>100% organic cotton ruby gem T-shirt</p>\"\nvalues[1].type #=> :html\nvalues[1].lang #=> \"en\""}]},"params":[{"name":"query","types":["String"],"description":"The query string in search query syntax. If the\nquery is <code class=\"highlighter-rouge\">nil</code> or empty, all documents are returned. For more\ninformation see <a href=\"https://cloud.google.com/search/query\">Query\nStrings</a>.","optional":false,"nullable":false},{"name":"expressions","types":["Hash"],"description":"Customized expressions used in <code class=\"highlighter-rouge\">order</code> or\n<code class=\"highlighter-rouge\">fields</code>. The expression can contain fields in Document, the built-in\nfields ( <code class=\"highlighter-rouge\">rank</code>, the document <code class=\"highlighter-rouge\">rank</code>, and <code class=\"highlighter-rouge\">score</code> if scoring is\nenabled) and fields defined in <code class=\"highlighter-rouge\">expressions</code>. All field expressions\nexpressed as a <code class=\"highlighter-rouge\">Hash</code> with the keys as the <code class=\"highlighter-rouge\">name</code> and the values as\nthe <code class=\"highlighter-rouge\">expression</code>. The expression value can be a combination of\nsupported functions encoded in the string. Expressions involving\nnumber fields can use the arithmetical operators (+, -, *, /) and the\nbuilt-in numeric functions (<code class=\"highlighter-rouge\">max</code>, <code class=\"highlighter-rouge\">min</code>, <code class=\"highlighter-rouge\">pow</code>, <code class=\"highlighter-rouge\">count</code>, <code class=\"highlighter-rouge\">log</code>,\n<code class=\"highlighter-rouge\">abs</code>). Expressions involving geopoint fields can use the <code class=\"highlighter-rouge\">geopoint</code>\nand <code class=\"highlighter-rouge\">distance</code> functions. Expressions for text and html fields can use\nthe <code class=\"highlighter-rouge\">snippet</code> function.","optional":true,"default":"nil","nullable":true},{"name":"matched_count_accuracy","types":["Integer"],"description":"Minimum accuracy requirement for\n{Result::List#matched_count}. If specified, <code class=\"highlighter-rouge\">matched_count</code> will be\naccurate to at least that number. For example, when set to 100, any\n<code>matched_count &lt;= 100</code> is accurate. This option may add\nconsiderable latency/expense. By default (when it is not specified or\nset to 0), the accuracy is the same as <code class=\"highlighter-rouge\">max</code>.","optional":true,"default":"nil","nullable":true},{"name":"offset","types":["Integer"],"description":"Used to advance pagination to an arbitrary\nresult, independent of the previous results. Offsets are an\ninefficient alternative to using <code class=\"highlighter-rouge\">token</code>. (Both cannot be both set.)\nThe default is 0.","optional":true,"default":"nil","nullable":true},{"name":"order","types":["String"],"description":"A comma-separated list of fields for sorting on\nthe search result, including fields from Document, the built-in fields\n(<code class=\"highlighter-rouge\">rank</code> and <code class=\"highlighter-rouge\">score</code>), and fields defined in expressions. The default\nsorting order is ascending. To specify descending order for a field, a\nsuffix <code>\" desc\"</code> should be appended to the field name. For\nexample: <code>orderBy=\"foo desc,bar\"</code>. The default value for\ntext sort is the empty string, and the default value for numeric sort\nis 0. If not specified, the search results are automatically sorted by\ndescending <code class=\"highlighter-rouge\">rank</code>. Sorting by ascending <code class=\"highlighter-rouge\">rank</code> is not allowed.","optional":true,"default":"nil","nullable":true},{"name":"fields","types":["String","Array<String>"],"description":"The fields to return in the\n{Search::Result} objects. These can be fields from {Document}, the\nbuilt-in fields <code class=\"highlighter-rouge\">rank</code> and <code class=\"highlighter-rouge\">score</code>, and fields defined in expressions.\nThe default is to return all fields.","optional":true,"default":"nil","nullable":true},{"name":"scorer","types":["String","Symbol"],"description":"The scoring function to invoke on a\nsearch result for this query. If scorer is not set, scoring is\ndisabled and <code class=\"highlighter-rouge\">score</code> is 0 for all documents in the search result. To\nenable document relevancy score based on term frequency, set <code class=\"highlighter-rouge\">scorer</code>\nto <code class=\"highlighter-rouge\">:generic</code>.","optional":true,"default":"nil","nullable":true},{"name":"scorer_size","types":["Integer"],"description":"Maximum number of top retrieved results to\nscore. It is valid only when <code class=\"highlighter-rouge\">scorer</code> is set. The default is 100.","optional":true,"default":"nil","nullable":true},{"name":"token","types":["String"],"description":"A previously-returned page token representing part\nof the larger set\nof results to view.","optional":true,"default":"nil","nullable":true},{"name":"max","types":["Integer"],"description":"Maximum number of results to return per page.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Array<Gcloud::Search::Result>"],"description":"(See\n{Gcloud::Search::Result::List})"}]},{"metadata":{"name":"ensure_connection!","description":"<p>Raise an error unless an active connection is available.</p>","source":"lib/gcloud/search/index.rb#L562","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]},{"metadata":{"name":"format_expressions","description":"","source":"lib/gcloud/search/index.rb#L566","resources":[],"examples":[]},"params":[],"exceptions":[],"returns":[]}]}
{"id":"google/cloud/logging/middleware","name":"Middleware","title":["Google","Cloud","Logging","Middleware"],"description":"","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L19","resources":[],"examples":[],"methods":[{"id":"logger-instance","type":"instance","name":"logger","title":["Google","Cloud","Logging","Middleware#logger"],"description":"<p>The Google::Cloud::Logging::Logger instance</p>","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L22","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"initialize-constructor","type":"constructor","name":"initialize","title":["Google","Cloud","Logging","Middleware#initialize"],"description":"<p>Create a new AppEngine logging Middleware.</p>","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L36","resources":[],"examples":[],"params":[{"name":"app","types":["Rack Application"],"description":"Rack application","optional":false,"nullable":false},{"name":"logger","types":["Google::Cloud::Logging::Logger"],"description":"A logger to be used by\nthis middleware. The middleware will be interacting with the logger\nto track Stackdriver request trace ID. It also properly sets\nenv[“rack.logger”] to this assigned logger for accessing.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"google/cloud/logging/middleware\">Google::Cloud::Logging::Middleware</a>"],"description":"A new\nGoogle::Cloud::Logging::Middleware instance"}]},{"id":"call-instance","type":"instance","name":"call","title":["Google","Cloud","Logging","Middleware#call"],"description":"<p>Rack middleware entry point. In most Rack based frameworks, a request\nis served by one thread. So entry point, we associate the GCP request\ntrace_id with the current thread’s object_id in logger. All the logs\nwritten by logger beyond this point will carry this request’s\ntrace_id. Untrack the trace_id with this thread upon exiting.</p>","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L52","resources":[],"examples":[],"params":[{"name":"env","types":["Hash"],"description":"Rack environment hash","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Rack::Response"],"description":"The response from downstream Rack app"}]},{"id":"extract_trace_id-instance","type":"instance","name":"extract_trace_id","title":["Google","Cloud","Logging","Middleware#extract_trace_id"],"description":"<p>Extract the trace_id from HTTP request header\nHTTP_X_CLOUD_TRACE_CONTEXT.</p>","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L69","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["String"],"description":"The trace_id or nil if trace_id is empty."}]},{"id":"build_monitored_resource-class","type":"class","name":"build_monitored_resource","title":["Google","Cloud","Logging","Middleware.build_monitored_resource"],"description":"<p>Construct a monitored resource based on the given type and label if\nboth are provided. Otherwise, construct a default monitored resource\nbased on the current environment.</p>\n\n<p>Reference https://cloud.google.com/logging/docs/api/ref_v2beta1/rest/v2beta1/MonitoredResource\nfor a full list of monitoring resources</p>","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L119","resources":[],"examples":[{"caption":"<p>If both type and labels are provided, it returns resource:</p>","code":"rc = Middleware.build_monitored_resource \"aws_ec2_instance\",\n                                         { instance_id: \"ec2-id\",\n                                           aws_account: \"aws-id\" }\nrc.type   #=> \"aws_ec2_instance\"\nrc.labels #=> { instance_id: \"ec2-id\", aws_account: \"aws-id\" }"},{"caption":"<p>If running from GAE, returns default resource:</p>","code":"rc = Middleware.build_monitored_resource\nrc.type   #=> \"gae_app\"\nrc.labels #=> { module_id: [GAE module name],\n          #     version_id: [GAE module version] }"},{"caption":"<p>If running from GKE, returns default resource:</p>","code":"rc = Middleware.build_monitored_resource\nrc.type   #=> \"container\"\nrc.labels #=> { cluster_name: [GKE cluster name],\n          #     namespace_id: [GKE namespace_id] }"},{"caption":"<p>If running from GCE, return default resource:</p>","code":"rc = Middleware.build_monitored_resource\nrc.type   #=> \"gce_instance\"\nrc.labels #=> { instance_id: [GCE VM instance id],\n          #     zone: [GCE vm group zone] }"},{"caption":"<p>Otherwise default to generic “global” type:</p>","code":"rc = Middleware.build_monitored_resource\nrc.type   #=> \"global\"\nrc.labels #=> {}"}],"params":[{"name":"type","types":["String"],"description":"Type of Google::Cloud::Logging::Resource","optional":true,"default":"nil","nullable":true},{"name":"labels","types":["Hash<String, String>"],"description":"Metadata lebels of\nGoogle::Cloud::Logging::Resource","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"google/cloud/logging/resource\">Google::Cloud::Logging::Resource</a>"],"description":"An Resource object with\ntype and labels"}]}]}